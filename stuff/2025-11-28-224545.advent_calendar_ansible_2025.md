# 2025年にEmacsでPlaybookを書く

本記事は [Ansible Advent Calendar 2025](https://qiita.com/advent-calendar/2025/ansible) の1日目の記事です。

## はじめに

世の中には数多くのエディタがあります。最近の人気具合を [Text Editor - Popularity Trends](https://ossinsight.io/collections/text-editor/trends/){:target="_blank"} で見ると、vscode が圧倒的に人気があり、次いで neovim となっています。我らがEmacsは残念ながらランキング圏外になっています(一応 spacemacs がランクインしていますが・・・）。

また Stack Overflow の調査結果を元にした [戦国時代だったテキストエディタ界をVisual Studio Codeが天下統一しつつある](https://gigazine.net/news/20210723-the-era-of-visual-studio-code/){:target="_blank"} を見ても、Emacs は安定して低空飛行の状態です。

とはいえ、Emacs は栄枯盛衰の激しいIT業界において半世紀にも渡って利用されおり、そこには他のエディタには無い魅力があるからです。

私自身、Emacs を20年以上使っており、普段の仕事の多くで利用しています。もちろん Ansible Playbook も Emacs で書いています。この記事では、Emacs ではどんな感じで開発を行なっているのかを紹介し、Emacs に興味を持つきっかけにできればと思っています。

## 素のEmacs

Emacs は Windows, Mac, Linux などメジャーな環境ではほぼ使えます。どのプラットフォームにインストールしても、初期状態の Emacs で Plabyook を書くとこんな感じになります。

<div><video controls src="./movies/emacs_1.mp4" muted="true" width="600"></video></div>

はい、ほぼメモ帳に書いているのとおなじような感じになります。基本的なコピー&ペーストやアンドゥといった操作はできますが、通常のショートカットとは異なり、Emacs独自のショートカットを用いる必要があります。

シンタックスハイライトもされず、お世辞にも使いやすいとは言えません。もはや修行です。

でも安心してください。Emacs には Emacs Lisp という専用言語を使って、いくらでも、それこそエディタという枠を超えて自由に動作を拡張・カスタマイズ可能です。この自由さこそが Emacs の真骨頂だとも言えます。自分の手癖に馴染むように事細かに挙動を変更できるため、一度調整して慣れてしまうと離れがたくなってしまうのです。

## 自分流にカスタマイズしたEmacs

自分が普段使っている Emacs 環境で Playbook を書くとこんな感じになります。

<div><video controls src="./movies/emacs_2.mp4" muted="true" width="600"></video></div>

一般的なエディタと同様に、シンタックスハイライトされ、インデントの深さが可視化され、CoPilot と連携してコード生成も使えちゃうのです。

### 生成AIを使ったコードのリライト・リファクタリング

生成AIとの連携でコードのリライトやリファクターをさせることも可能です。以下は ChatGPT を使って Playbook の一部をインラインでリライトしている様子です。

<div><video controls src="./movies/emacs_3.mp4" muted="true" width="600"></video></div>

### たまに便利なマルチカーソル

vim や vscode で使えるマルチカーソルもいけちゃいます。複数の場所にちょっとした文字列を差し込みたいときに便利です(置換の正規表現を考えるのが面倒なときに使います)

<div><video controls src="./movies/emacs_4.mp4" muted="true" width="600"></video></div>

## 個人的によく使う Emacs のパッケージ

Emacs では Emacs を拡張するための Emacs Lisp をパッケージとして

今回の動画に登場しているもの
  - [yaml-mode]() YAMLのインタックスハイライト要
  - [highlight-indent-guide]() インデントの深さを可視化
  - [copilot-mode]() CoPilot連携
  - [gptel]() 様々な生成AIと連携するためのフロントエンド機能
  - [multi-cursors]() マルチカーソル機能






